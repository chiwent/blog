(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{73:function(t,a,s){"use strict";s.r(a);var n=s(0),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"web的基本性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web的基本性能优化","aria-hidden":"true"}},[t._v("#")]),t._v(" web的基本性能优化")]),s("p",[t._v("本文通过介绍从输入网址到网页加载完成的过程中，浏览器的各类行为，分析各个步骤的关键因素来优化网页的性能"),s("br"),t._v("\n在了解web性能优化前，我们需要知道一些基本的概念："),s("br")]),s("p",[t._v("前端性能优化有一个指标，叫做“关键路径渲染优化”，指的是从DOM树构建到绘制到屏幕上的整个过程中的优化因素"),s("br")]),s("p",[t._v("关于首屏和白屏时间："),s("br")]),s("ul",[s("li",[t._v("白屏时间是指浏览器从响应用户输入网址地址，到浏览器开始显示内容的时间。")]),s("li",[t._v("首屏时间是指浏览器从响应用户输入网络地址，到首屏内容渲染完成的时间。")]),s("li",[t._v("白屏时间 = 地址栏输入网址后回车 - 浏览器出现第一个元素")]),s("li",[t._v("首屏时间 = 地址栏输入网址后回车 - 浏览器第一屏渲染完成\n-影响白屏时间的因素：网络，服务端性能，前端页面结构设计。")]),s("li",[t._v("影响首屏时间的因素：白屏时间，资源下载执行时间。")])]),s("p",[s("a",{attrs:{href:"https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A6%96%E5%B1%8F%E5%92%8C%E7%99%BD%E5%B1%8F%E6%97%B6%E9%97%B4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考")])]),s("p",[s("code",[t._v("DOMContentLoaded")]),t._v("是指页面元素加载完毕（$(document).ready就是监听该方法），此时的一些静态资源如图片还不可见，但是页面是可以交互的；"),s("code",[t._v("load")]),t._v("是值所有资源都加载完毕（$(document).load）监听的就是该事件"),s("br")]),s("h2",{attrs:{id:"浏览器的结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的结构","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器的结构")]),s("h4",{attrs:{id:"_1-用户界面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户界面","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.用户界面")]),s("h4",{attrs:{id:"_2-浏览器引擎"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-浏览器引擎","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.浏览器引擎")]),s("p",[t._v("在用户界面和渲染引擎之间传输指令")]),s("h4",{attrs:{id:"_3-渲染引擎"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-渲染引擎","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.渲染引擎")]),s("p",[t._v("负责显示请求的内容，解析获取到的资源将其呈现在屏幕上。chrome用的是Blink，firefox用的是Gecko。。。")]),s("h4",{attrs:{id:"_4-网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-网络","aria-hidden":"true"}},[t._v("#")]),t._v(" 4.网络")]),s("h4",{attrs:{id:"_5-用户界面后端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-用户界面后端","aria-hidden":"true"}},[t._v("#")]),t._v(" 5.用户界面后端")]),s("p",[t._v("绘制浏览器的基本组件，如窗口，由系统调用")]),s("h4",{attrs:{id:"_6-javascript解释器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-javascript解释器","aria-hidden":"true"}},[t._v("#")]),t._v(" 6.JavaScript解释器")]),s("p",[t._v("解析和执行js")]),s("h4",{attrs:{id:"_7-数据存储"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-数据存储","aria-hidden":"true"}},[t._v("#")]),t._v(" 7.数据存储")]),s("p",[t._v("在硬盘上存储各类数据，如cookie、localstorage")]),s("h2",{attrs:{id:"基本的工作流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本的工作流程","aria-hidden":"true"}},[t._v("#")]),t._v(" 基本的工作流程")]),s("h3",{attrs:{id:"_1-加载内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-加载内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.加载内容")]),s("p",[t._v("当我们在浏览器地址栏中输入网址后，浏览器会提交URL，DNS服务器进行域名解析后，再向对应的服务器发起请求，接收文件(包括了html、css、js、静态资源等等)")]),s("h3",{attrs:{id:"_2-解析资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-解析资源","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.解析资源")]),s("p",[t._v("浏览器在收到服务端发来的资源后，会进行解析，建立对应的结构树（如html的DOM树，CSSOM树）")]),s("h4",{attrs:{id:"html的解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#html的解析","aria-hidden":"true"}},[t._v("#")]),t._v(" HTML的解析")]),s("p",[t._v("一般的，浏览器引擎从网络获取到文档后，会将文档分成8kb大小的分分块进行传输。"),s("br"),t._v("\nHTML解析器对HTML文档进行解析，生成解析树(以DOM元素以及属性作为节点的树)"),s("br"),t._v("\n浏览器对于html的解析具有一定的容错机制，会纠正错误无效的内容，尽管如此我们也应该避免。"),s("br"),t._v("\n解析树构建完成后，浏览器开始加载网页的外部资源，首先进行css样式文件的解析，每个css文件都会被解析成一个样式表对象。"),s("br"),s("img",{attrs:{src:"https://raw.githubusercontent.com/chiwend/img/master/PciGowebkit-css-parse.png",alt:"css解析规则"}}),t._v("\ncss的样式匹配是从左往右进行的，如果换成从右往左，那么就要找到最顶层的元素再依次向下寻找，如果都不匹配就回到最顶层元素，通过另外一条路径进行匹配，这样就大大增加了成本。所以在书写css的时候应该尽可能高效："),s("br")]),s("ul",[s("li",[t._v("不要在ID选择器前使用标签名")]),s("li",[t._v("尽量不要在class选择器前使用标签名")]),s("li",[t._v("尽量减少嵌套层级")]),s("li",[t._v("避免使用通配符")]),s("li",[t._v("避免使用后代选择符，尽量使用子选择符，子元素匹配符的概率要大于后代元素匹配符")]),s("li",[t._v("减少内联css")])]),s("h3",{attrs:{id:"_3-渲染"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-渲染","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.渲染")]),s("p",[t._v("将前面解析到的DOM和CSSOM合并成为一个渲染树(render)，构建渲染树时，对每个元素进行位置、样式的计算，生成布局(Layout)，然后将内容绘制在屏幕上(Paint)\n"),s("br")]),s("h4",{attrs:{id:"阻塞解析和阻塞渲染的因素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阻塞解析和阻塞渲染的因素","aria-hidden":"true"}},[t._v("#")]),t._v(" 阻塞解析和阻塞渲染的因素")]),s("p",[t._v("渲染树是有DOM树和CSSOM树构建而成，所以，"),s("b",[t._v("DOM和CSSOM的构建会影响到后续的渲染")]),t._v("。其中，js的解析会阻塞DOM树的渲染（因为js的操作可能引起回流，且浏览器无法预估它会有什么具体的操作，并且js是加载后马上执行的），而css不会阻塞DOM的解析但会阻塞DOM的渲染(前提是没有js对DOM和样式进行处理)。"),s("br"),t._v("\n并且，CSSOM的构建会影响到js的执行，如果在浏览器未完成CSSOM的下载和构建时，执行js，那么浏览器会延迟js的执行和DOM的构建，直到完成CSSOM的下载和构建。我们可以理解为，CSSOM构建完成时间是早于js的执行的，二者是早于DOMContentLoaded（DOM构建彻底完成）的。"),s("br"),t._v("\n正因为如此，我们也可以很好理解，为什么"),s("code",[t._v("<script>")]),t._v("标签通常是放在html文档下面，而"),s("code",[t._v("<link>")]),t._v("放在顶部。"),s("br"),t._v("\n为了防止js阻塞DOM的解析，我们应该尽可能合并脚本，并且将script放在页面body闭合标签前，也可以在"),s("code",[t._v("<script>")]),t._v("标签内增加"),s("code",[t._v("defer")]),t._v("和"),s("code",[t._v("async")]),t._v("属性，或者通过js动态插入脚本。"),s("br")]),s("p",[s("code",[t._v("defer")]),t._v("和"),s("code",[t._v("async")]),t._v("的区别："),s("br")]),s("ul",[s("li",[t._v("async在加载和渲染后续文档的过程中将和js的加载与执行并行进行")]),s("li",[t._v("defer在加载后续文档的过程中将和js的解析并行进行，但是js的执行要在所有的元素解析完成后，DOMContentLoaded事件触发之前完成。使用"),s("code",[t._v("defer")]),t._v("的js执行不一定按照顺序进行，谁先加载完成就先执行，所以显得不是很严谨")])]),s("p",[t._v("用js来动态加载："),s("br")]),s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("loadScript")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" callback"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" script "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'script'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'text/javascript'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),s("span",{attrs:{class:"token comment"}},[t._v("//IE下")]),t._v("\n        script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),s("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'loaded'")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("||")]),t._v(" script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),s("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'complete'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onreadystatechange "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("null")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{attrs:{class:"token function"}},[t._v("callback")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token keyword"}},[t._v("else")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{attrs:{class:"token comment"}},[t._v("//其他浏览器")]),t._v("\n        script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token function"}},[t._v("callback")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    script"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" url"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("getElementsByTagName")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'head'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{attrs:{class:"token number"}},[t._v("0")]),s("span",{attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("p",[t._v("CSSOM构建的优化："),s("br"),t._v("\n在渲染树的关键渲染路径中，CSSOM也扮演着很重要的角色，我们应该想办法尽可能精简它，除此，我们还可以使用媒体类型和媒体查询来接触对渲染的阻塞："),s("br")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("index.css"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("print.css"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("media")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("print"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("other.css"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("stylesheet"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("media")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(min-width: 30em) and (orientation: landscape)"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("ul",[s("li",[t._v("第一个资源会加载并阻塞。")]),s("li",[t._v("第二个资源设置了媒体类型，会加载但不会阻塞，print 声明只在打印网页时使用。")]),s("li",[t._v("第三个资源提供了媒体查询，会在符合条件时阻塞渲染。")])]),s("p",[t._v("至于一些图片之类的静态资源，实际上，它们并不会阻塞首屏的渲染（所以有些网页的结构已经加载完成了，但是图片还没加载完），但是我们也应该考虑用户的体验优化图片的加载，雪碧图和懒加载是我们常用的一些方法。"),s("br")]),s("p",[t._v("简单概括一下阻塞解析和阻塞渲染的因素："),s("br"),t._v("\njavascript阻止DOM构建（DOMCommentLoaded触发被延迟），css的下载和完成阻止javascript的执行。在没有javascript或者只含有异步javascript的页面中，DOM的构建和CSSOM的构建互不影响。"),s("br")]),s("h3",{attrs:{id:"网页首次加载完成后的性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网页首次加载完成后的性能优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 网页首次加载完成后的性能优化")]),s("p",[t._v("网页加载完成后，我们还是可能会对DOM进行操作，这个过程同样会涉及到网页的性能优化。"),s("br")]),s("h4",{attrs:{id:"重绘-reflow-和回流-repaint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重绘-reflow-和回流-repaint","aria-hidden":"true"}},[t._v("#")]),t._v(" 重绘(Reflow)和回流(Repaint)")]),s("p",[t._v("它们的关系是：回流会导致重绘，重绘不一定会回流"),s("br")]),s("ul",[s("li",[s("p",[t._v("重绘：当页面中元素样式的改变不影响它在文档流中的位置时，比如颜色、背景色、透明度等，浏览器会根据样式的变化重新对变化的元素进行绘制")])]),s("li",[s("p",[t._v("回流：当文档中的元素尺寸、结构等属性发生变化时，浏览器会重新渲染部分或全部的文档的过程\n会触发回流的的操作："),s("br")])]),s("li",[s("p",[t._v("页面首次渲染")])]),s("li",[s("p",[t._v("浏览器窗口尺寸改变")])]),s("li",[s("p",[t._v("元素尺寸或位置改变(position为absolute和fixed时的位置变化不触发)")])]),s("li",[s("p",[t._v("元素内容变化")])]),s("li",[s("p",[t._v("添加或删除可见的DOM元素")])]),s("li",[s("p",[t._v("激活css伪类")])]),s("li",[s("p",[t._v("通过js获取某些属性或方法，比如clientWidth、getComputedStyle、getBoundingClientRect......")])])]),s("p",[t._v("如何避免回流："),s("br"),t._v("\nCSS的操作："),s("br")]),s("ul",[s("li",[t._v("避免使用"),s("code",[t._v("<table>")])]),s("li",[t._v("尽可能在DOM树末端改变class")]),s("li",[t._v("避免设置多层内联样式")]),s("li",[t._v("将动画应用到position为absolute或fixed的元素上")]),s("li",[t._v("避免使用css表达式如calc")])]),s("p",[t._v("js的操作："),s("br")]),s("ul",[s("li",[t._v("避免频繁操作样式，最好一次性重写style属性，或者将样式列表定义为class并一次性更改class属性。")]),s("li",[t._v("避免频繁操作DOM，创建一个documentFragment，在它上面应用所有DOM操作，最后再把它添加到文档中。")]),s("li",[t._v("也可以先为元素设置display: none，操作结束后再把它显示出来。因为在display属性为none的元素上进行的DOM操作不会引发回流和重绘。")]),s("li",[t._v("避免频繁读取会引发回流/重绘的属性，如果确实需要多次使用，就用一个变量缓存起来。\n对具有复杂动画的元素使用绝对定位，使它脱离文档流，否则会引起父元素及后续元素频繁回流。")])]),s("h3",{attrs:{id:"其他的性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他的性能优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他的性能优化")]),s("h4",{attrs:{id:"关于动画"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关于动画","aria-hidden":"true"}},[t._v("#")]),t._v(" 关于动画")]),s("p",[t._v("最普通的动画，我们可能会使用"),s("code",[t._v("setTimeout")]),t._v("来实现，但是由于不同显示器的刷新率可能不一样，可能会导致动画掉帧的现象，所以，我们可以用css3动画或者"),s("code",[t._v("requestAnimationframe")]),t._v("来优化"),s("br")]),s("h4",{attrs:{id:"关于dom的监听"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关于dom的监听","aria-hidden":"true"}},[t._v("#")]),t._v(" 关于DOM的监听")]),s("p",[t._v("在js中，我们可能会对DOM做长时间的监听，如果事件触发很频繁，但是对用户体验却毫无意义，我们可以使用防抖和节流来优化"),s("br")]),s("h4",{attrs:{id:"实验性的功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实验性的功能","aria-hidden":"true"}},[t._v("#")]),t._v(" 实验性的功能")]),s("h5",{attrs:{id:"preload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#preload","aria-hidden":"true"}},[t._v("#")]),t._v(" preload")]),s("p",[t._v("preload 提供了一种声明式的命令，让浏览器提前加载指定资源(加载后并不执行)，在需要执行的时候再执行。它给我们带来的好处："),s("br")]),s("ul",[s("li",[t._v("将加载和执行分离，防止阻塞渲染")]),s("li",[t._v("优化用户体验，不会出现网页结构加载完成而部分静态资源还没加载出来")])]),s("p",[t._v("哪些类型的内容可以被预加载？"),s("br"),t._v("\n参考："),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Preloading_content#%E5%93%AA%E4%BA%9B%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%86%85%E5%AE%B9%E5%8F%AF%E4%BB%A5%E8%A2%AB%E9%A2%84%E5%8A%A0%E8%BD%BD%EF%BC%9F",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN")]),s("br")]),s("p",[t._v("怎么用？"),s("br"),t._v("\n一个基本的例子："),s("br")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("style.css"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("as")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("style"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("main.js"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("as")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("script"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("注意，要使用 "),s("code",[t._v("as")]),t._v(" 来指定将要预加载的内容的类型"),s("br"),t._v("\n如果涉及到跨域获取资源，我们可以设置"),s("code",[t._v("crossorigin")]),t._v("属性："),s("br")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("fonts/cicle_fina-webfont.svg"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("as")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("font"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image/svg+xml"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("crossorigin")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("anonymous"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("如果是需要响应式开发，可以使用媒体查询，像下面这样："),s("br")]),s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bg-image-narrow.png"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("as")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("media")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(max-width: 600px)"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token tag"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bg-image-wide.png"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("as")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("image"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{attrs:{class:"token attr-name"}},[t._v("media")]),s("span",{attrs:{class:"token attr-value"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(min-width: 601px)"),s("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),s("p",[t._v("预加载的资源的优先级全部会提高，所以一些不确定的资源也是会被预先加载的，如果盲目使用预加载，势必增加移动端用户的流量"),s("br"),t._v("\n预加载机制的兼容性较差，目前IE都无法兼容，所以谨慎使用"),s("br")]),s("h5",{attrs:{id:"prefetch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prefetch","aria-hidden":"true"}},[t._v("#")]),t._v(" prefetch")]),s("p",[t._v("prefetch允许浏览器在后台（空闲时）获取将来可能用得到的资源，并且将他们存储在浏览器的缓存中"),s("br"),t._v("\n使用类似preload："),s("code",[t._v('<link rel="prefetch" href="/uploads/images/pic.png">')]),s("br"),t._v("\npreload 和 prefetch 混用的话，并不会复用资源，而是会重复加载。"),s("br")]),s("h4",{attrs:{id:"移动端的一些性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#移动端的一些性能优化","aria-hidden":"true"}},[t._v("#")]),t._v(" 移动端的一些性能优化")]),s("ul",[s("li",[t._v("不要给非static的定位元素增加css动画，比如relative、absolute")]),s("li",[t._v("尽可能设置硬件加速，比如在渲染图片时可以使用canvas绘图。或者给元素设置"),s("code",[t._v("transform: translate3d(0,0,0)")]),t._v("，这样元素本身没有外观上的变化，但是它的渲染会触发GPU加速")])]),s("br"),s("hr"),s("br"),s("h3",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考")]),s("ul",[s("li",[s("a",{attrs:{href:"https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/#The_browser_main_functionality",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器的工作原理：新式网络浏览器幕后揭秘")])]),s("li",[s("a",{attrs:{href:"https://github.com/fi3ework/blog/issues/16",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化之关键路径渲染优化")])]),s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000015019450",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化之--页面渲染优化全面解析")])]),s("li",[s("a",{attrs:{href:"https://juejin.im/post/5a9923e9518825558251c96a",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器的回流与重绘 (Reflow & Repaint)")])]),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/29418126",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器的渲染：过程与原理")])]),s("li",[s("a",{attrs:{href:"https://segmentfault.com/q/1010000000640869",target:"_blank",rel:"noopener noreferrer"}},[t._v("javascript - defer和async的区别- SegmentFault 思否")])]),s("li",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTML/Preloading_content#%E5%93%AA%E4%BA%9B%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%86%85%E5%AE%B9%E5%8F%AF%E4%BB%A5%E8%A2%AB%E9%A2%84%E5%8A%A0%E8%BD%BD%EF%BC%9F",target:"_blank",rel:"noopener noreferrer"}},[t._v('通过rel="preload"进行内容预加载')])]),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/33759023",target:"_blank",rel:"noopener noreferrer"}},[t._v("用 preload 预加载页面资源")])]),s("li",[s("a",{attrs:{href:"https://github.com/fi3ework/blog/issues/32",target:"_blank",rel:"noopener noreferrer"}},[t._v("译-资源提示 —— 什么是 Preload，Prefetch 和 Preconnect？")])]),s("li",[s("a",{attrs:{href:"https://juejin.im/post/58e8acf10ce46300585a7a42",target:"_blank",rel:"noopener noreferrer"}},[t._v("Preload，Prefetch 和它们在 Chrome 之中的优先级")])]),s("li",[s("a",{attrs:{href:"https://juejin.im/post/5a966bd16fb9a0635172a50a",target:"_blank",rel:"noopener noreferrer"}},[t._v("2018 前端性能优化清单")])])])])}],!1,null,null,null);a.default=r.exports}}]);